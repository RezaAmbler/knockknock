# Knock Knock Security Scanner Configuration
#
# This file configures the behavior of the knock_knock.py security scanner.
# All settings have reasonable defaults and can be customized as needed.

# ============================================================================
# Masscan Configuration (Stage 1: Fast Port Discovery)
# ============================================================================
masscan:
  # Path to masscan binary (use 'masscan' if in PATH)
  # Note: masscan requires sudo/root privileges for raw socket access
  binary: "masscan"

  # Packet rate limit in packets per second (PPS)
  # This controls how fast masscan scans each host
  #
  # ⚠️  IMPORTANT PPS SAFETY CONSIDERATIONS:
  #
  # Total network PPS = (max_concurrent_hosts × masscan_rate)
  #
  # Examples:
  #   - 10 concurrent hosts × 1000 pps = 10,000 total PPS
  #   - 5 concurrent hosts × 2000 pps = 10,000 total PPS
  #   - 20 concurrent hosts × 500 pps = 10,000 total PPS
  #
  # Recommendations:
  #   - Keep total PPS under 10,000 to avoid network congestion
  #   - For production networks, start conservative (500-1000 pps)
  #   - Higher rates = faster scans but more network impact
  #
  # Timing examples (per host, all 65536 ports):
  #   - 100 pps:   ~11 minutes
  #   - 500 pps:   ~2 minutes
  #   - 1000 pps:  ~75 seconds
  #   - 5000 pps:  ~15 seconds (use with caution!)
  #
  # Default: 1000 pps (safe with 10 concurrent hosts = 10k total PPS)
  rate: 1000

  # Network interface to use (optional)
  # If not specified, masscan will auto-detect the default interface
  # Set this if you encounter "could not determine default interface" errors
  # Common values: en0, en1, eth0, eth1, wlan0
  # To find your interface: ifconfig (macOS/Linux) or ipconfig (Windows)
  interface: null

# ============================================================================
# Nmap Configuration (Stage 2: Detailed Port Analysis)
# ============================================================================
nmap:
  # Path to nmap binary (use 'nmap' if in PATH)
  binary: "nmap"

  # Nmap command-line arguments
  # Note: Do NOT include -p or -oX here; the script adds them automatically
  #
  # *** TWO-STAGE SCANNING WORKFLOW ***
  # 1. masscan quickly discovers ALL open ports (0-65535)
  # 2. nmap performs detailed analysis ONLY on discovered ports
  #
  # This means you NO LONGER NEED -p- or -F flags!
  # The port list is automatically generated from masscan results.
  #
  # Recommended arguments:
  #   -sV         : Version detection (probe open ports to determine service/version)
  #   -sC         : Run default NSE scripts (safe, useful scripts)
  #   -T4         : Timing template "aggressive" (faster scanning)
  #   -Pn         : Skip host discovery (treat all hosts as online)
  #
  # For quieter/stealthier scanning:
  #   args: ["-sV", "-sC", "-T2", "-Pn"]   # Slower timing
  args:
    - "-sV"
    - "-sC"
    - "-T2"
    - "-Pn"

# ============================================================================
# SSH Audit Configuration
# ============================================================================
ssh_audit:
  # Path to ssh-audit binary (use 'ssh-audit' if in PATH)
  binary: "ssh-audit"

  # List of ports to scan with ssh-audit
  # SSH may run on non-standard ports in some environments
  # Common SSH-related ports:
  #   22    : Standard SSH
  #   830   : NETCONF over SSH (used by network devices)
  #   2222  : Alternative SSH port
  ports:
    - 22
    - 830

# ============================================================================
# Concurrency and Timeout Settings
# ============================================================================
concurrency:
  # Maximum number of hosts to scan concurrently
  # Higher values = faster scanning but more resource usage
  # Recommended: 5-20 depending on your system and network
  max_concurrent_hosts: 10

  # Per-host timeout in seconds
  # This is the total time allowed for a single host to complete all three stages:
  #   - Stage 1 - masscan (gets 20% of this timeout)
  #   - Stage 2 - nmap (gets 70% of this timeout)
  #   - Stage 3 - ssh-audit (gets 10% of this timeout)
  #
  # Recommended timeouts with two-stage scanning:
  #   - Normal usage:      600-900 seconds (10-15 minutes)
  #   - Conservative:      1200 seconds (20 minutes)
  #   - Many open ports:   1800 seconds (30 minutes)
  #
  # Note: With masscan doing fast port discovery, nmap only scans discovered
  # ports, making scans much faster than the old -p- approach!
  host_timeout_seconds: 1200

# ============================================================================
# Email / SMTP Configuration
# ============================================================================
email:
  # SMTP server hostname
  # Example: "smtp.company.com", "mail.example.com", "10.0.1.50"
  smtp_host: "smtp.gmail.com"

  # SMTP server port
  # Common values:
  #   25   : Standard SMTP (no encryption)
  #   587  : SMTP with STARTTLS
  #   465  : SMTP with implicit TLS/SSL
  smtp_port: 587

  # Whether to use TLS/STARTTLS
  # Set to true for port 587, false for port 25
  smtp_use_tls: true

  # SMTP Authentication (optional)
  # Required for Gmail and most modern SMTP servers
  # For Gmail: Use your email and an App Password (not your regular password)
  # Generate App Password: https://myaccount.google.com/apppasswords
  smtp_username: null
  smtp_password: null



  # Email 'From' address
  from_address: "from-address-example@github.com"

  # Email 'To' addresses (list)
  # Can specify multiple recipients
  to_addresses:
    - "reza.ambler@gmail.com"

  # Subject line prefix
  # The date will be appended automatically: "<prefix> - YYYY-MM-DD"
  subject_prefix: "Knock Knock Weekly Security Scan"

# ============================================================================
# Database / History Configuration
# ============================================================================
database:
  # Enable SQLite-based logging of scan results
  # When enabled, all scan runs and results are stored in an append-only database
  # This enables historical reporting and trend analysis
  enabled: true

  # Path to SQLite database file
  # The parent directory will be created if it doesn't exist
  # Default: /var/lib/knockknock/knockknock.db
  path: "db/knockknock.db"

# ============================================================================
# Reporting Configuration
# ============================================================================
reporting:
  # List of ports to highlight in the HTML report
  # These ports will be visually emphasized (bold/highlighted row)
  # Common important ports:
  #   22     : SSH
  #   23     : Telnet (insecure)
  #   80     : HTTP
  #   443    : HTTPS
  #   3389   : RDP (Remote Desktop)
  #   8443   : HTTPS alternate
  #   8080   : HTTP alternate
  ports_of_interest:
    - 22
    - 23
    - 80
    - 443
    - 3389
    - 8080
    - 8443

  # Title for HTML reports
  report_title: "Knock Knock Security Scan Report"
